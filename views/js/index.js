/*! For license information please see index.js.LICENSE.txt */
!function(t){var e={};function n(o){if(e[o])return e[o].exports;var i=e[o]={i:o,l:!1,exports:{}};return t[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(o,i,function(e){return t[e]}.bind(null,i));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=1)}([,function(t,e,n){t.exports=n(3)},,function(t,e,n){"use strict";n.r(e);const{$:o}=window;class i{constructor(t){this.id=t,this.$container=o(`#${this.id}_grid`)}getId(){return this.id}getContainer(){return this.$container}getHeaderContainer(){return this.$container.closest(".js-grid-panel").find(".js-grid-header")}addExtension(t){t.extend(this)}}class s{extend(t){t.getHeaderContainer().on("click",".js-common_refresh_list-grid-action",()=>{window.location.reload()})}}const{$:a}=window;class r{extend(t){t.getHeaderContainer().on("click",".js-common_show_query-grid-action",()=>this.onShowSqlQueryClick(t)),t.getHeaderContainer().on("click",".js-common_export_sql_manager-grid-action",()=>this.onExportSqlManagerClick(t))}onShowSqlQueryClick(t){const e=a(`#${t.getId()}_common_show_query_modal_form`);this.fillExportForm(e,t);const n=a(`#${t.getId()}_grid_common_show_query_modal`);n.modal("show"),n.on("click",".btn-sql-submit",()=>e.submit())}onExportSqlManagerClick(t){const e=a(`#${t.getId()}_common_show_query_modal_form`);this.fillExportForm(e,t),e.submit()}fillExportForm(t,e){const n=e.getContainer().find(".js-grid-table").data("query");t.find('textarea[name="sql"]').val(n),t.find('input[name="name"]').val(this.getNameFromBreadcrumb())}getNameFromBreadcrumb(){const t=a(".header-toolbar").find(".breadcrumb-item");let e="";return t.each((t,n)=>{const o=a(n),i=o.find("a").length>0?o.find("a").text():o.text();e.length>0&&(e=e.concat(" > ")),e=e.concat(i)}),e}}const{$:c}=window;var d=function(t,e){c.post(t).then(()=>window.location.assign(e))};const{$:l}=window;class m{extend(t){t.getContainer().on("click",".js-reset-search",t=>{d(l(t.currentTarget).data("url"),l(t.currentTarget).data("redirect"))})}}const{$:u}=window;var h=class{constructor(t){this.selector=".ps-sortable-column",this.columns=u(t).find(this.selector)}attach(){this.columns.on("click",t=>{const e=u(t.delegateTarget);this.sortByColumn(e,this.getToggledSortDirection(e))})}sortBy(t,e){const n=this.columns.is(`[data-sort-col-name="${t}"]`);if(!n)throw new Error(`Cannot sort by "${t}": invalid column`);this.sortByColumn(n,e)}sortByColumn(t,e){window.location=this.getUrl(t.data("sortColName"),"desc"===e?"desc":"asc",t.data("sortPrefix"))}getToggledSortDirection(t){return"asc"===t.data("sortDirection")?"desc":"asc"}getUrl(t,e,n){const o=new URL(window.location.href),i=o.searchParams;return n?(i.set(n+"[orderBy]",t),i.set(n+"[sortOrder]",e)):(i.set("orderBy",t),i.set("sortOrder",e)),o.toString()}};class f{extend(t){const e=t.getContainer().find("table.table");new h(e).attach()}}const{$:b}=window;class g{extend(t){this.initRowLinks(t),this.initConfirmableActions(t)}initConfirmableActions(t){t.getContainer().on("click",".js-link-row-action",t=>{const e=b(t.currentTarget).data("confirm-message");e.length&&!window.confirm(e)&&t.preventDefault()})}initRowLinks(t){b("tr",t.getContainer()).each((function(){const t=b(this);b(".js-link-row-action[data-clickable-row=1]:first",t).each((function(){const e=b(this),n=e.closest("td"),o=b("td.clickable",t).not(n);let i=!1;o.addClass("cursor-pointer").mousedown(()=>{b(window).mousemove(()=>{i=!0,b(window).unbind("mousemove")})}),o.mouseup(()=>{const t=i;if(i=!1,b(window).unbind("mousemove"),!t){const t=e.data("confirm-message");t.length&&!window.confirm(t)||(document.location=e.attr("href"))}})}))}))}}const{$:w}=window;class p{constructor(){return{extend:t=>this.extend(t)}}extend(t){t.getHeaderContainer().on("click",".js-grid-action-submit-btn",e=>{this.handleSubmit(e,t)})}handleSubmit(t,e){const n=w(t.currentTarget),o=n.data("confirm-message");if(void 0!==o&&o.length>0&&!window.confirm(o))return;const i=w(`#${e.getId()}_filter_form`);i.attr("action",n.data("url")),i.attr("method",n.data("method")),i.find(`input[name="${e.getId()}[_token]"]`).val(n.data("csrf")),i.submit()}}const{$:B}=window;function k(t,e,n){const{id:o,closable:i}=t;this.modal=function({id:t="confirm-modal",confirmTitle:e,confirmMessage:n="",closeButtonLabel:o="Close",confirmButtonLabel:i="Accept",confirmButtonClass:s="btn-primary",customButtons:a=[]}){const r={};r.container=document.createElement("div"),r.container.classList.add("modal","fade"),r.container.id=t,r.dialog=document.createElement("div"),r.dialog.classList.add("modal-dialog"),r.content=document.createElement("div"),r.content.classList.add("modal-content"),r.header=document.createElement("div"),r.header.classList.add("modal-header"),e&&(r.title=document.createElement("h4"),r.title.classList.add("modal-title"),r.title.innerHTML=e);r.closeIcon=document.createElement("button"),r.closeIcon.classList.add("close"),r.closeIcon.setAttribute("type","button"),r.closeIcon.dataset.dismiss="modal",r.closeIcon.innerHTML="Ã—",r.body=document.createElement("div"),r.body.classList.add("modal-body","text-left","font-weight-normal"),r.message=document.createElement("p"),r.message.classList.add("confirm-message"),r.message.innerHTML=n,r.footer=document.createElement("div"),r.footer.classList.add("modal-footer"),r.closeButton=document.createElement("button"),r.closeButton.setAttribute("type","button"),r.closeButton.classList.add("btn","btn-outline-secondary","btn-lg"),r.closeButton.dataset.dismiss="modal",r.closeButton.innerHTML=o,r.confirmButton=document.createElement("button"),r.confirmButton.setAttribute("type","button"),r.confirmButton.classList.add("btn",s,"btn-lg","btn-confirm-submit"),r.confirmButton.dataset.dismiss="modal",r.confirmButton.innerHTML=i,e?r.header.append(r.title,r.closeIcon):r.header.appendChild(r.closeIcon);return r.body.appendChild(r.message),r.footer.append(r.closeButton,...a,r.confirmButton),r.content.append(r.header,r.body,r.footer),r.dialog.appendChild(r.content),r.container.appendChild(r.dialog),r}(t),this.$modal=B(this.modal.container),this.show=()=>{this.$modal.modal()},this.modal.confirmButton.addEventListener("click",e),this.$modal.modal({backdrop:!!i||"static",keyboard:void 0===i||i,closable:void 0===i||i,show:!1}),this.$modal.on("hidden.bs.modal",()=>{document.querySelector("#"+o).remove(),n&&n()}),document.body.appendChild(this.modal.container)}const{$:C}=window;class x{constructor(){return{extend:t=>this.extend(t)}}extend(t){t.getContainer().on("click",".js-bulk-action-submit-btn",e=>{this.submit(e,t)})}submit(t,e){const n=C(t.currentTarget),o=n.data("confirm-message"),i=n.data("confirmTitle");void 0!==o&&o.length>0?void 0!==i?this.showConfirmModal(n,e,o,i):window.confirm(o)&&this.postForm(n,e):this.postForm(n,e)}showConfirmModal(t,e,n,o){const i=t.data("confirmButtonLabel"),s=t.data("closeButtonLabel"),a=t.data("confirmButtonClass");new k({id:e.getId()+"-grid-confirm-modal",confirmTitle:o,confirmMessage:n,confirmButtonLabel:i,closeButtonLabel:s,confirmButtonClass:a},()=>this.postForm(t,e)).show()}postForm(t,e){const n=C(`#${e.getId()}_filter_form`);n.attr("action",t.data("form-url")),n.attr("method",t.data("form-method")),n.submit()}}const{$:y}=window;class _{extend(t){this.handleBulkActionCheckboxSelect(t),this.handleBulkActionSelectAllCheckbox(t)}handleBulkActionSelectAllCheckbox(t){t.getContainer().on("change",".js-bulk-action-select-all",e=>{const n=y(e.currentTarget).is(":checked");n?this.enableBulkActionsBtn(t):this.disableBulkActionsBtn(t),t.getContainer().find(".js-bulk-action-checkbox").prop("checked",n)})}handleBulkActionCheckboxSelect(t){t.getContainer().on("change",".js-bulk-action-checkbox",()=>{t.getContainer().find(".js-bulk-action-checkbox:checked").length>0?this.enableBulkActionsBtn(t):this.disableBulkActionsBtn(t)})}enableBulkActionsBtn(t){t.getContainer().find(".js-bulk-actions-btn").prop("disabled",!1)}disableBulkActionsBtn(t){t.getContainer().find(".js-bulk-actions-btn").prop("disabled",!0)}}const{$:v}=window;class L{extend(t){t.getContainer().on("click",".js-submit-row-action",e=>{e.preventDefault();const n=v(e.currentTarget),o=n.data("confirmMessage"),i=n.data("title"),s=n.data("method");if(i)this.showConfirmModal(n,t,o,i,s);else{if(o.length&&!window.confirm(o))return;this.postForm(n,s)}})}postForm(t,e){const n=["GET","POST"].includes(e),o=v("<form>",{action:t.data("url"),method:n?e:"POST"}).appendTo("body");n||o.append(v("<input>",{type:"_hidden",name:"_method",value:e})),o.submit()}showConfirmModal(t,e,n,o,i){const s=t.data("confirmButtonLabel"),a=t.data("closeButtonLabel"),r=t.data("confirmButtonClass");new k({id:e.getId()+"-grid-confirm-modal",confirmTitle:o,confirmMessage:n,confirmButtonLabel:s,closeButtonLabel:a,confirmButtonClass:r},()=>this.postForm(t,i)).show()}}(0,window.$)(()=>{const t=new i("stockemailalerts");t.addExtension(new s),t.addExtension(new r),t.addExtension(new m),t.addExtension(new f),t.addExtension(new g),t.addExtension(new p),t.addExtension(new x),t.addExtension(new _),t.addExtension(new L)})}]);
